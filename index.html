<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#FF6B6B">
    <title>å®å¯æ¢¦æ‹¼éŸ³å¤§æœæŸ¥ | PokÃ©mon Pinyin Quest</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
            background: linear-gradient(135deg, #FFB6C1 0%, #87CEEB 50%, #98FB98 100%);
            height: 100vh;
            overflow: hidden;
            touch-action: manipulation;
        }

        #app {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        /* é¡¶éƒ¨å¯¼èˆªæ  */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }

        .navbar h1 {
            font-size: 36px;
            color: #FF6B9D;
            display: flex;
            align-items: center;
            gap: 12px;
            text-shadow: 2px 2px 4px rgba(255, 107, 157, 0.3);
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
        }

        .nav-btn {
            padding: 18px 35px;
            border: none;
            border-radius: 30px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            touch-action: manipulation;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .nav-btn.primary {
            background: linear-gradient(135deg, #FF6B9D 0%, #FF8FB2 100%);
            color: white;
        }

        .nav-btn.secondary {
            background: linear-gradient(135deg, #4ECDC4 0%, #72DFD8 100%);
            color: white;
        }

        .nav-btn:active {
            transform: scale(0.95);
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        /* æ¸¸æˆä¸»ç•Œé¢ */
        .game-container {
            flex: 1;
            display: none; /* é»˜è®¤éšè— */
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            padding: 15px;
            position: relative;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .game-container.active {
            display: flex; /* æ¿€æ´»æ—¶æ˜¾ç¤º */
        }

        /* è‰ä¸› */
        .grass-patch {
            width: 280px;
            height: 280px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle fill="%2345B649" cx="50" cy="50" r="40"/><path fill="%2338A33C" d="M30,50 Q35,30 40,50 Q45,30 50,50 Q55,30 60,50 Q65,30 70,50"/></svg>') center/contain no-repeat;
            cursor: pointer;
            animation: shake 2s ease-in-out infinite;
            transition: transform 0.2s;
            filter: drop-shadow(0 8px 15px rgba(0,0,0,0.3));
            margin-top: 60px;
        }

        .grass-patch:active {
            transform: scale(0.95);
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            25% { transform: translateX(-5px) rotate(-2deg); }
            75% { transform: translateX(5px) rotate(2deg); }
        }

        .hint-text {
            margin-top: 20px;
            color: white;
            font-size: 26px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.4);
            animation: pulse 2s ease-in-out infinite;
            background: rgba(0, 0, 0, 0.2);
            padding: 12px 25px;
            border-radius: 18px;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        /* å®å¯æ¢¦é­é‡ç•Œé¢ */
        .encounter-screen {
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            width: 100%;
            max-width: 600px;
            padding-bottom: 30px;
        }

        .encounter-screen.active {
            display: flex;
        }

        .pokemon-display {
            width: 220px;
            height: 220px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.25);
            position: relative;
            overflow: hidden;
            border: 5px solid rgba(255, 255, 255, 0.8);
        }

        .pokemon-display img {
            width: 180px;
            height: 180px;
            object-fit: contain;
            transition: filter 0.5s;
        }

        .pokemon-display.shadow img {
            filter: brightness(0);
        }

        .pokemon-name {
            font-size: 36px;
            font-weight: bold;
            color: white;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.6);
            background: rgba(0, 0, 0, 0.35);
            padding: 12px 30px;
            border-radius: 20px;
        }

        .pokemon-name .highlight {
            color: #FF6B9D;
            background: white;
            padding: 5px 15px;
            border-radius: 12px;
            box-shadow: 0 0 20px rgba(255, 107, 157, 0.6);
            animation: highlight-pulse 1.5s ease-in-out infinite;
        }

        @keyframes highlight-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* é¢˜ç›®åŒºåŸŸ */
        .question-area {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 25px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.25);
            text-align: center;
            min-width: auto;
            width: 90%;
            max-width: 500px;
            border: 4px solid rgba(255, 255, 255, 0.8);
        }

        .question-text {
            font-size: 28px;
            color: #333;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .pinyin-blank {
            font-size: 40px;
            color: #FF6B9D;
            font-weight: bold;
            letter-spacing: 4px;
            text-shadow: 2px 2px 4px rgba(255, 107, 157, 0.3);
        }

        /* é‡è¯»æŒ‰é’® */
        .repeat-btn {
            margin-top: 15px;
            padding: 12px 28px;
            font-size: 22px;
            background: linear-gradient(135deg, #4ECDC4 0%, #72DFD8 100%);
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(78, 205, 196, 0.4);
            transition: all 0.3s;
        }

        .repeat-btn:active {
            transform: scale(0.95);
        }

        /* é€‰é¡¹æŒ‰é’®ï¼ˆç²¾çµçƒï¼‰ */
        .options-container {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        /* è¿çº¿æ¨¡å¼çš„å·¦å³åˆ†ç»„ */
        .connect-group {
            display: flex;
            flex-direction: row;
            gap: 15px;
            padding: 20px;
            border-radius: 20px;
        }

        .connect-group.left-group {
            background: linear-gradient(135deg, rgba(255, 182, 193, 0.3) 0%, rgba(255, 192, 203, 0.2) 100%);
            border-right: 3px dashed rgba(255, 107, 157, 0.4);
            padding-right: 25px;
        }

        .connect-group.right-group {
            background: linear-gradient(135deg, rgba(135, 206, 250, 0.3) 0%, rgba(173, 216, 230, 0.2) 100%);
            padding-left: 25px;
        }

        .pokeball-option {
            width: 110px;
            height: 110px;
            background: radial-gradient(circle at 50% 45%, #FF3B3B 50%, #1A1A1A 50%, #1A1A1A 52%, #fff 52%);
            border-radius: 50%;
            border: 5px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            transition: transform 0.3s, box-shadow 0.3s, opacity 0.3s;
            box-shadow: 0 6px 15px rgba(0,0,0,0.4);
        }

        .pokeball-option:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 30px rgba(0,0,0,0.5);
        }

        .pokeball-option::after {
            content: '';
            position: absolute;
            width: 30px;
            height: 30px;
            background: white;
            border: 5px solid #333;
            border-radius: 50%;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.3);
        }

        .pokeball-option span {
            position: relative;
            z-index: 1;
            font-size: 36px;
            font-weight: bold;
            color: #333;
            background: white;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid #333;
        }

        .pokeball-option:active {
            transform: scale(0.95) rotate(10deg);
        }

        .pokeball-option.shake {
            animation: pokeball-shake 0.5s ease-in-out 3;
        }

        @keyframes pokeball-shake {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-15deg); }
            75% { transform: rotate(15deg); }
        }

        /* è¿çº¿æ¨¡å¼é€‰ä¸­çŠ¶æ€ */
        .pokeball-option.selected {
            border: 5px solid #FFD700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
            animation: pulse-glow 1s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.8); }
            50% { box-shadow: 0 0 30px rgba(255, 215, 0, 1); }
        }

        /* å›¾é‰´ç•Œé¢ */
        .pokedex-screen {
            display: none;
            padding: 20px;
            padding-bottom: 60px; /* åº•éƒ¨ç•™ç™½ï¼Œæ–¹ä¾¿æ»šåŠ¨ */
            overflow-y: auto;
            overflow-x: hidden;
            width: 100%;
            height: 100%;
            -webkit-overflow-scrolling: touch; /* iOS å¹³æ»‘æ»šåŠ¨ */
        }

        .pokedex-screen.active {
            display: block;
        }

        /* å›¾é‰´ç­›é€‰å™¨ */
        .pokedex-filter {
            text-align: center;
            margin: 25px auto;
            max-width: 700px;
        }

        .filter-toggle {
            display: inline-flex;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 35px;
            padding: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            gap: 12px;
        }

        .filter-btn {
            padding: 20px 50px;
            border: none;
            border-radius: 30px;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            background: transparent;
            color: #999;
        }

        .filter-btn.active {
            background: linear-gradient(135deg, #FF6B9D 0%, #FF8FB2 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(255, 107, 157, 0.4);
        }

        .filter-btn:active {
            transform: scale(0.95);
        }

        .pokedex-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 25px;
            max-width: 1400px;
            margin: 0 auto;
            padding-bottom: 30px;
        }

        .pokedex-card {
            background: white;
            border-radius: 25px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            border: 4px solid rgba(255, 255, 255, 0.6);
            position: relative;
        }

        .pokedex-sound-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            background: linear-gradient(135deg, #4ECDC4 0%, #72DFD8 100%);
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(78, 205, 196, 0.4);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .pokedex-sound-btn:hover {
            transform: scale(1.1);
        }

        .pokedex-sound-btn:active {
            transform: scale(0.95);
        }

        .pokedex-card img {
            width: 140px;
            height: 140px;
            object-fit: contain;
        }

        .pokedex-card.locked img {
            filter: brightness(0);
            opacity: 0.3;
        }

        .pokedex-card .pokemon-info {
            margin-top: 15px;
            font-size: 28px;
            font-weight: bold;
            color: #333;
            line-height: 1.6;
        }

        .pokedex-card .pokemon-info small {
            font-size: 22px;
        }

        .pokedex-card.locked .pokemon-info {
            color: #999;
        }

        /* åé¦ˆå¼¹çª— */
        .feedback-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .feedback-modal.active {
            display: flex;
        }

        .feedback-content {
            background: white;
            padding: 50px;
            border-radius: 35px;
            text-align: center;
            max-width: 600px;
            box-shadow: 0 15px 60px rgba(0,0,0,0.6);
            border: 6px solid rgba(255, 255, 255, 0.8);
        }

        .feedback-content h2 {
            font-size: 48px;
            margin-bottom: 25px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .feedback-content.success h2 {
            color: #4ECDC4;
        }

        .feedback-content.error h2 {
            color: #FF6B9D;
        }

        .feedback-content p {
            font-size: 28px;
            line-height: 1.8;
            margin: 20px 0;
            color: #555;
        }

        .feedback-content button {
            margin-top: 30px;
            padding: 20px 50px;
            font-size: 28px;
            border: none;
            border-radius: 30px;
            background: linear-gradient(135deg, #FFB6C1 0%, #87CEEB 100%);
            color: white;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .feedback-content button:active {
            transform: scale(0.95);
        }

        /* å›¾é‰´ä¿¡æ¯å¡ç‰‡ */
        .pokedex-info-card {
            background: linear-gradient(135deg, #FFB6C1 0%, #87CEEB 100%);
            padding: 30px;
            border-radius: 25px;
            margin: 25px 0;
            color: white;
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        .pokedex-info-card img {
            width: 200px;
            height: 200px;
            object-fit: contain;
            background: white;
            border-radius: 20px;
            padding: 15px;
            margin: 15px auto;
            display: block;
            animation: capture-success 0.8s ease-out;
        }

        @keyframes capture-success {
            0% { transform: scale(0) rotate(0deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(180deg); }
            100% { transform: scale(1) rotate(360deg); opacity: 1; }
        }

        .pokedex-info-card .info-row {
            margin: 10px 0;
            font-size: 18px;
            line-height: 1.6;
        }

        .pokedex-info-card .info-label {
            font-weight: bold;
            color: #FFE66D;
        }

        /* åº†ç¥ç‰¹æ•ˆ */
        .celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: #FFE66D;
            animation: confetti-fall 3s linear forwards;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* é—ªå…‰æ•ˆæœ */
        .sparkle {
            position: absolute;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, white 20%, transparent 70%);
            border-radius: 50%;
            animation: sparkle-animation 1s ease-out forwards;
        }

        @keyframes sparkle-animation {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        /* é”™è¯¯æŠ–åŠ¨æ•ˆæœ */
        .shake-error {
            animation: shake-error 0.5s ease-in-out;
        }

        @keyframes shake-error {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }

        .feedback-content.error {
            border: 3px solid #FF6B6B;
        }

        .feedback-content.success {
            border: 3px solid #4ECDC4;
        }

        /* è®¾ç½®ç•Œé¢ */
        .settings-screen {
            display: none;
            padding: 40px;
            color: white;
            text-align: center;
        }

        .settings-screen.active {
            display: block;
        }

        .settings-screen h2 {
            font-size: 48px;
            margin-bottom: 40px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .settings-section {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 25px;
            padding: 30px;
            margin: 25px auto;
            max-width: 600px;
        }

        .settings-section h3 {
            font-size: 32px;
            margin-bottom: 20px;
        }

        .speed-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .speed-btn {
            padding: 15px 30px;
            font-size: 24px;
            background: rgba(255, 255, 255, 0.3);
            color: white;
            border: 3px solid white;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            min-width: 100px;
        }

        .speed-btn.active {
            background: linear-gradient(135deg, #FF6B9D 0%, #FF8FB2 100%);
            border-color: #FF6B9D;
            box-shadow: 0 4px 12px rgba(255, 107, 157, 0.4);
            transform: scale(1.1);
        }

        .speed-btn:active {
            transform: scale(0.95);
        }

        .settings-btn {
            display: block;
            width: 100%;
            max-width: 600px;
            margin: 25px auto;
            padding: 25px;
            font-size: 28px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .settings-btn.danger {
            background: #FF6B6B;
            color: white;
        }

        .settings-btn:active {
            transform: scale(0.95);
        }

        /* å“åº”å¼é€‚é… */
        @media (max-width: 768px) {
            .navbar h1 {
                font-size: 18px;
            }

            .nav-btn {
                padding: 8px 15px;
                font-size: 14px;
            }

            .question-area {
                min-width: auto;
                width: 100%;
            }

            .pokeball-option {
                width: 100px;
                height: 100px;
            }

            .pokeball-option span {
                width: 50px;
                height: 50px;
                font-size: 28px;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <nav class="navbar">
            <h1>ğŸ® å®å¯æ¢¦æ‹¼éŸ³å¤§æœæŸ¥</h1>
            <div class="nav-buttons">
                <button class="nav-btn primary" onclick="showScreen('game')">æ¸¸æˆ</button>
                <button class="nav-btn secondary" onclick="showScreen('pokedex')">å›¾é‰´</button>
                <button class="nav-btn secondary" onclick="showScreen('settings')">è®¾ç½®</button>
            </div>
        </nav>

        <!-- æ¸¸æˆä¸»ç•Œé¢ -->
        <div id="gameScreen" class="game-container active">
            <!-- åˆå§‹è‰ä¸› -->
            <div id="grassPatch" class="grass-patch" onclick="encounterPokemon()"></div>
            <div class="hint-text">ğŸ‘† ç‚¹å‡»è‰ä¸›å¯»æ‰¾å®å¯æ¢¦ï¼</div>

            <!-- é­é‡ç•Œé¢ -->
            <div id="encounterScreen" class="encounter-screen">
                <div class="pokemon-name" id="pokemonName"></div>
                <div class="pokemon-display shadow" id="pokemonDisplay">
                    <img id="pokemonImage" src="" alt="å®å¯æ¢¦">
                </div>
                <div class="question-area">
                    <div class="question-text">è¿™ä¸ªå­—æ€ä¹ˆè¯»ï¼Ÿ</div>
                    <div class="pinyin-blank" id="pinyinBlank">P_</div>
                    <button class="repeat-btn" onclick="repeatQuestion()">ğŸ”Š é‡æ–°è¯»é¢˜</button>
                </div>
                <div class="options-container" id="optionsContainer">
                    <!-- ç²¾çµçƒé€‰é¡¹å°†é€šè¿‡JSç”Ÿæˆ -->
                </div>
            </div>
        </div>

        <!-- å›¾é‰´ç•Œé¢ -->
        <div id="pokedexScreen" class="pokedex-screen">
            <div class="pokedex-filter">
                <div class="filter-toggle">
                    <button class="filter-btn active" onclick="setPokedexFilter('captured')">âœ… å·²æ•è·</button>
                    <button class="filter-btn" onclick="setPokedexFilter('all')">ğŸ“‹ å…¨éƒ¨</button>
                </div>
            </div>
            <div class="pokedex-grid" id="pokedexGrid">
                <!-- å›¾é‰´å¡ç‰‡å°†é€šè¿‡JSç”Ÿæˆ -->
            </div>
        </div>

        <!-- è®¾ç½®ç•Œé¢ -->
        <div id="settingsScreen" class="settings-screen">
            <h2>âš™ï¸ è®¾ç½®</h2>

            <div class="settings-section">
                <h3>ğŸ® æ¸¸æˆæ¨¡å¼</h3>
                <p style="font-size: 22px; margin-bottom: 20px;">é€‰æ‹©ç­”é¢˜æ–¹å¼</p>
                <div class="speed-controls">
                    <button class="speed-btn" id="modeSelectBtn" onclick="setGameMode('select')">ç‚¹å‡»é€‰æ‹©</button>
                    <button class="speed-btn" id="modeConnectBtn" onclick="setGameMode('connect')">è¿çº¿æ‹¼éŸ³</button>
                </div>
            </div>

            <div class="settings-section">
                <h3>ğŸ”Š è¯­éŸ³é€Ÿåº¦</h3>
                <p style="font-size: 22px; margin-bottom: 20px;">é€‰æ‹©è¯»é¢˜é€Ÿåº¦</p>
                <div class="speed-controls">
                    <button class="speed-btn" onclick="setSpeechSpeed(0.6)">å¾ˆæ…¢</button>
                    <button class="speed-btn" onclick="setSpeechSpeed(0.8)">æ…¢</button>
                    <button class="speed-btn active" onclick="setSpeechSpeed(1.0)">æ­£å¸¸</button>
                    <button class="speed-btn" onclick="setSpeechSpeed(1.2)">å¿«</button>
                    <button class="speed-btn" onclick="setSpeechSpeed(1.4)">å¾ˆå¿«</button>
                </div>
            </div>

            <button class="settings-btn danger" onclick="clearData()">ğŸ—‘ï¸ æ¸…é™¤æ‰€æœ‰è¿›åº¦</button>
            <button class="settings-btn secondary" onclick="showScreen('game')" style="background: linear-gradient(135deg, #4ECDC4 0%, #72DFD8 100%);">è¿”å›æ¸¸æˆ</button>
        </div>

        <!-- åé¦ˆå¼¹çª— -->
        <div id="feedbackModal" class="feedback-modal">
            <div class="feedback-content" id="feedbackContent">
                <h2 id="feedbackTitle">å¤ªæ£’äº†ï¼</h2>
                <p id="feedbackMessage">æ•æ‰æˆåŠŸï¼</p>
                <button onclick="closeFeedback()">ç»§ç»­å†’é™©</button>
            </div>
        </div>
    </div>

    <!-- åŠ è½½å®å¯æ¢¦æ•°æ®åº“ï¼ˆå…¨éƒ¨1025åªå®å¯æ¢¦ï¼‰ -->
    <script src="pokemon_database.js"></script>

    <script>
        // å®å¯æ¢¦æ•°æ®åº“å·²ä» pokemon_database.js åŠ è½½
        // åŒ…å«å…¨éƒ¨1025åªå®å¯æ¢¦çš„ä¸­æ–‡åç§°ã€æ‹¼éŸ³å’ŒæŒ‘æˆ˜é¢˜ç›®

        // æ¸¸æˆçŠ¶æ€
        let currentPokemon = null;
        let currentChallenge = null;
        let capturedPokemon = loadProgress();
        let pokedexFilter = 'captured'; // å›¾é‰´ç­›é€‰æ¨¡å¼ï¼š'captured' æˆ– 'all'
        let speechSpeed = 1.0; // è¯­éŸ³é€Ÿåº¦ï¼š0.6-1.4
        let errorCount = 0; // å½“å‰é­é‡çš„é”™è¯¯æ¬¡æ•°
        let gameMode = localStorage.getItem('gameMode') || 'select'; // æ¸¸æˆæ¨¡å¼ï¼š'select' æˆ– 'connect'
        let connectSelection = { first: null, second: null }; // è¿çº¿æ¨¡å¼çš„é€‰æ‹©çŠ¶æ€

        // è¯­éŸ³åˆæˆç³»ç»Ÿ
        const synth = window.speechSynthesis;
        let voiceCache = null;

        // è·å–ä¸­æ–‡è¯­éŸ³
        function getChineseVoice() {
            if (voiceCache) return voiceCache;
            const voices = synth.getVoices();
            // ä¼˜å…ˆé€‰æ‹©ä¸­æ–‡è¯­éŸ³
            voiceCache = voices.find(v => v.lang.includes('zh')) || voices[0];
            return voiceCache;
        }

        // æ’­æ”¾è¯­éŸ³
        function speak(text, rate = null) {
            // å–æ¶ˆä¹‹å‰çš„è¯­éŸ³
            synth.cancel();

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'zh-CN';
            utterance.rate = rate || speechSpeed; // ä½¿ç”¨ä¼ å…¥çš„é€Ÿåº¦æˆ–å…¨å±€è®¾ç½®çš„é€Ÿåº¦
            utterance.pitch = 1;
            utterance.volume = 1;

            // ç­‰å¾…è¯­éŸ³åŠ è½½
            if (synth.getVoices().length === 0) {
                synth.addEventListener('voiceschanged', () => {
                    utterance.voice = getChineseVoice();
                    synth.speak(utterance);
                }, { once: true });
            } else {
                utterance.voice = getChineseVoice();
                synth.speak(utterance);
            }
        }

        // è®¾ç½®æ¸¸æˆæ¨¡å¼
        function setGameMode(mode) {
            gameMode = mode;

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.getElementById('modeSelectBtn').classList.remove('active');
            document.getElementById('modeConnectBtn').classList.remove('active');

            if (mode === 'select') {
                document.getElementById('modeSelectBtn').classList.add('active');
                speak('åˆ‡æ¢åˆ°ç‚¹å‡»é€‰æ‹©æ¨¡å¼');
            } else {
                document.getElementById('modeConnectBtn').classList.add('active');
                speak('åˆ‡æ¢åˆ°è¿çº¿æ‹¼éŸ³æ¨¡å¼');
            }

            // ä¿å­˜åˆ°localStorage
            localStorage.setItem('gameMode', mode);
        }

        // è®¾ç½®è¯­éŸ³é€Ÿåº¦
        function setSpeechSpeed(speed) {
            speechSpeed = speed;

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.speed-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // ä¿å­˜åˆ°localStorage
            localStorage.setItem('speechSpeed', speed);

            // æ’­æ”¾ç¤ºä¾‹
            speak('é€Ÿåº¦å·²æ›´æ”¹');
        }

        // é‡æ–°è¯»é¢˜
        function repeatQuestion() {
            if (!currentPokemon || !currentChallenge) return;

            const charIndex = currentChallenge.charIndex;
            const targetChar = currentPokemon.name.split('')[charIndex];
            const fullPinyin = currentPokemon.pinyin[charIndex];

            speak(`${targetChar}å­—ï¼Œ${fullPinyin}`);
        }

        // è¯»å‡ºå®å¯æ¢¦åç§°
        function speakPokemonName(pokemonId) {
            const pokemon = pokemonDatabase.find(p => p.id === pokemonId);
            if (!pokemon) return;

            // è¯»å‡ºåç§°å’Œæ‹¼éŸ³
            const nameText = pokemon.name.split('').join('ï¼Œ');
            const pinyinText = pokemon.pinyin.join(' ');
            speak(`${nameText}ï¼Œæ‹¼éŸ³ï¼š${pinyinText}`);
        }

        // æ‹†åˆ†æ‹¼éŸ³ä¸ºå£°æ¯å’ŒéŸµæ¯
        function splitPinyin(pinyin) {
            // å»æ‰å£°è°ƒè·å–åŸºç¡€å½¢å¼
            const base = pinyin.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase();

            // å£°æ¯åˆ—è¡¨ï¼ˆæŒ‰é•¿åº¦æ’åºï¼Œä¼˜å…ˆåŒ¹é…é•¿çš„ï¼‰
            const initials = ['zh', 'ch', 'sh', 'b', 'p', 'm', 'f', 'd', 't', 'n', 'l', 'g', 'k', 'h', 'j', 'q', 'x', 'z', 'c', 's', 'r', 'y', 'w'];

            for (const initial of initials) {
                if (base.startsWith(initial)) {
                    const final = pinyin.slice(initial.length);
                    return { initial, final, base: pinyin };
                }
            }

            // é›¶å£°æ¯
            return { initial: '', final: pinyin, base: pinyin };
        }

        // æ‹¼è¯»æ‹¼éŸ³ï¼ˆå£°æ¯æ•™å­¦éŸ³+éŸµæ¯æ•™å­¦éŸ³+å®Œæ•´æ‹¼éŸ³ï¼‰
        function speakPinyinWithTeaching(pinyin, char) {
            const { initial, final } = splitPinyin(pinyin);

            let speech = '';

            // è¯»å£°æ¯æ•™å­¦éŸ³
            if (initial) {
                const initialTeaching = pinyinTeaching[initial];
                if (initialTeaching) {
                    speech += initialTeaching;
                }
            }

            // è¯»éŸµæ¯æ•™å­¦éŸ³æˆ–éŸµæ¯æœ¬èº«
            const baseFinal = final.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase();
            const finalTeaching = pinyinTeaching[baseFinal];
            if (finalTeaching) {
                speech += finalTeaching;
            } else {
                speech += final;
            }

            // è¯»å®Œæ•´çš„å­—
            speech += char;

            return speech;
        }

        // ç”Ÿæˆå¹²æ‰°é¡¹ï¼ˆè¿çº¿æ¨¡å¼ï¼‰
        function generateDistractors(correctInitial, correctFinal, initialCount, finalCount) {
            const distractors = [];
            const allInitials = ['b', 'p', 'm', 'f', 'd', 't', 'n', 'l', 'g', 'k', 'h', 'j', 'q', 'x', 'zh', 'ch', 'sh', 'r', 'z', 'c', 's', 'y', 'w'];
            const allFinals = ['a', 'o', 'e', 'i', 'u', 'Ã¼', 'ai', 'ei', 'ui', 'ao', 'ou', 'iu', 'ie', 'Ã¼e', 'er', 'an', 'en', 'in', 'un', 'Ã¼n', 'ang', 'eng', 'ing', 'ong'];

            // è¿‡æ»¤æ‰æ­£ç¡®ç­”æ¡ˆ
            const availableInitials = allInitials.filter(i => i !== correctInitial);
            const availableFinals = allFinals.filter(f => f !== correctFinal.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase());

            // ç”Ÿæˆå£°æ¯å¹²æ‰°é¡¹
            for (let i = 0; i < initialCount && availableInitials.length > 0; i++) {
                const randomIndex = Math.floor(Math.random() * availableInitials.length);
                const distractor = availableInitials.splice(randomIndex, 1)[0];
                distractors.push({ value: distractor, type: 'distractor-initial' });
            }

            // ç”ŸæˆéŸµæ¯å¹²æ‰°é¡¹
            for (let i = 0; i < finalCount && availableFinals.length > 0; i++) {
                const randomIndex = Math.floor(Math.random() * availableFinals.length);
                const distractor = availableFinals.splice(randomIndex, 1)[0];
                distractors.push({ value: distractor, type: 'distractor-final' });
            }

            return distractors;
        }

        // å¤„ç†è¿çº¿æ¨¡å¼çš„ç‚¹å‡»
        function handleConnectClick(pokeball) {
            const value = pokeball.getAttribute('data-value');
            const type = pokeball.getAttribute('data-type');

            if (!connectSelection.first) {
                // ç¬¬ä¸€æ¬¡ç‚¹å‡»
                connectSelection.first = { value, type, element: pokeball };
                pokeball.classList.add('selected');
                speak(value);
            } else if (connectSelection.first.element === pokeball) {
                // ç‚¹å‡»åŒä¸€ä¸ªï¼Œå–æ¶ˆé€‰æ‹©
                pokeball.classList.remove('selected');
                connectSelection.first = null;
            } else {
                // ç¬¬äºŒæ¬¡ç‚¹å‡»ï¼Œå°è¯•è¿çº¿
                connectSelection.second = { value, type, element: pokeball };
                pokeball.classList.add('selected');

                // æ£€æŸ¥è¿çº¿æ˜¯å¦æ­£ç¡®
                setTimeout(() => {
                    checkConnection();
                }, 300);
            }
        }

        // æ£€æŸ¥è¿çº¿æ˜¯å¦æ­£ç¡®
        function checkConnection() {
            const { first, second } = connectSelection;
            if (!first || !second) return;

            // è·å–æ­£ç¡®ç­”æ¡ˆ
            const charIndex = currentChallenge ? currentChallenge.charIndex : 0;
            const correctPinyin = currentPokemon.pinyin[charIndex];
            const { initial: correctInitial, final: correctFinal } = splitPinyin(correctPinyin);

            // åˆ¤æ–­æ˜¯å¦æ­£ç¡®ï¼ˆé¡ºåºæ— å…³ï¼‰
            const isCorrect = (
                (first.type === 'initial' && first.value === correctInitial && second.type === 'final' && second.value === correctFinal) ||
                (first.type === 'final' && first.value === correctFinal && second.type === 'initial' && second.value === correctInitial)
            );

            if (isCorrect) {
                // è¿çº¿æ­£ç¡®
                checkAnswer('correct-connection');
            } else {
                // è¿çº¿é”™è¯¯
                errorCount++;
                speak('ä¸å¯¹');

                // ç§»é™¤é€‰ä¸­çŠ¶æ€
                first.element.classList.remove('selected');
                second.element.classList.remove('selected');

                // é‡ç½®é€‰æ‹©
                connectSelection = { first: null, second: null };

                // æ£€æŸ¥æ˜¯å¦è¾¾åˆ°é”™è¯¯ä¸Šé™
                if (errorCount >= 2) {
                    setTimeout(() => {
                        speak(`æ­£ç¡®ç­”æ¡ˆæ˜¯${correctPinyin}ï¼Œå®å¯æ¢¦é€ƒèµ°äº†`);
                        setTimeout(() => {
                            closeFeedback();
                        }, 2500);
                    }, 1200);
                }
            }
        }

        // æ£€æŸ¥æ‹¼éŸ³ç»„åˆæ˜¯å¦æœ‰æ•ˆï¼ˆå®Œæ•´ç‰ˆï¼‰
        function isValidPinyin(initial, final) {
            // é›¶å£°æ¯çš„æƒ…å†µ
            if (initial === '') return true;

            // å»æ‰å£°è°ƒè·å–åŸºç¡€å½¢å¼
            const baseFinal = final.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase();

            // æ±‰è¯­æ‹¼éŸ³çš„æœ‰æ•ˆç»„åˆè§„åˆ™
            const rules = {
                // w åªèƒ½è·Ÿ a, ai, an, ang, ei, en, eng, o, u å¼€å¤´çš„éŸµæ¯
                'w': /^(a|ai|an|ang|ei|en|eng|o|u)/,

                // y åªèƒ½è·Ÿç‰¹å®šéŸµæ¯
                'y': /^(a|ao|an|ang|e|i|in|ing|o|ong|ou|u|uan|un|ue)/,

                // zh, ch, sh, r ä¸èƒ½è·Ÿ Ã¼ å’Œä»¥ Ã¼ å¼€å¤´çš„éŸµæ¯
                'zh': /^(?!Ã¼|Ã¼e|Ã¼an|Ã¼n)/,
                'ch': /^(?!Ã¼|Ã¼e|Ã¼an|Ã¼n)/,
                'sh': /^(?!Ã¼|Ã¼e|Ã¼an|Ã¼n)/,
                'r': /^(?!Ã¼|Ã¼e|Ã¼an|Ã¼n)/,

                // j, q, x åªèƒ½è·Ÿ i, Ã¼ æˆ–ä»¥å®ƒä»¬å¼€å¤´çš„éŸµæ¯
                'j': /^(i|ia|ian|iang|iao|ie|in|ing|iong|iu|Ã¼|Ã¼e|Ã¼an|Ã¼n)/,
                'q': /^(i|ia|ian|iang|iao|ie|in|ing|iong|iu|Ã¼|Ã¼e|Ã¼an|Ã¼n)/,
                'x': /^(i|ia|ian|iang|iao|ie|in|ing|iong|iu|Ã¼|Ã¼e|Ã¼an|Ã¼n)/,

                // b, p, m, f ä¸èƒ½è·Ÿ Ã¼ å’Œä»¥ Ã¼ å¼€å¤´çš„éŸµæ¯
                'b': /^(?!Ã¼|Ã¼e|Ã¼an|Ã¼n)/,
                'p': /^(?!Ã¼|Ã¼e|Ã¼an|Ã¼n)/,
                'm': /^(?!Ã¼|Ã¼e|Ã¼an|Ã¼n)/,
                'f': /^(?!Ã¼|Ã¼e|Ã¼an|Ã¼n)/,
            };

            // æ£€æŸ¥æ˜¯å¦æœ‰è¯¥å£°æ¯çš„è§„åˆ™
            if (rules[initial]) {
                return rules[initial].test(baseFinal);
            }

            // å…¶ä»–å£°æ¯é»˜è®¤å…è®¸ï¼ˆd, t, n, l, g, k, h, z, c, sï¼‰
            return true;
        }

        // æ‹¼éŸ³æ•™å­¦å£è¯€ï¼ˆç”¨äºè¯­éŸ³æ’­æŠ¥ï¼‰
        const pinyinTeaching = {
            // å£°æ¯
            'p': 'å¡', 'b': 'æ³¢', 'd': 'å¾—', 't': 'ç‰¹',
            'm': 'æ‘¸', 'f': 'ä½›', 'n': 'å‘¢', 'l': 'å‹’',
            'g': 'å“¥', 'k': 'ç§‘', 'h': 'å–',
            'j': 'é¸¡', 'q': 'ä¸ƒ', 'x': 'è¥¿',
            'z': 'èµ„', 'c': 'è¯', 's': 'æ€',
            'y': 'åŒ»', 'w': 'å±‹', 'r': 'æ—¥',
            'zh': 'çŸ¥', 'ch': 'åƒ', 'sh': 'è¯—',
            // å¤§å†™å£°æ¯ï¼ˆç”¨äºæŸ¥æ‰¾ï¼‰
            'P': 'å¡', 'B': 'æ³¢', 'D': 'å¾—', 'T': 'ç‰¹',
            'M': 'æ‘¸', 'F': 'ä½›', 'N': 'å‘¢', 'L': 'å‹’',
            'G': 'å“¥', 'K': 'ç§‘', 'H': 'å–',
            'J': 'é¸¡', 'Q': 'ä¸ƒ', 'X': 'è¥¿',
            'Z': 'èµ„', 'C': 'è¯', 'S': 'æ€',
            'Y': 'åŒ»', 'W': 'å±‹', 'R': 'æ—¥',
            // éŸµæ¯
            'a': 'å•Š', 'o': 'å–”', 'e': 'é¹…',
            'i': 'è¡£', 'u': 'ä¹Œ', 'Ã¼': 'é±¼',
            'ai': 'å“€', 'ei': 'è¯¶', 'ui': 'å¨', 'ao': 'ç†¬', 'ou': 'æ¬§', 'iu': 'ä¼˜',
            'ie': 'è€¶', 'Ã¼e': 'çº¦', 'er': 'å„¿',
            'an': 'å®‰', 'en': 'æ©', 'in': 'å› ', 'un': 'æ¸©', 'Ã¼n': 'æ™•',
            'ang': 'æ˜‚', 'eng': 'äº¨', 'ing': 'è‹±', 'ong': 'ç¿'
        };

        // æ•™å­¦å£è¯€æ•°æ®åº“
        const teachingTips = {
            "b-d": "è®°ä½å£è¯€ï¼šå·¦ä¸‹åŠåœ† d d dï¼Œå³ä¸‹åŠåœ† b b bï¼",
            "p-q": "è®°ä½å£è¯€ï¼šå·¦ä¸ŠåŠåœ† q q qï¼Œå³ä¸ŠåŠåœ† p p pï¼",
            "ang-eng": "è®°ä½ï¼šang æ˜¯åé¼»éŸ³ï¼Œeng æ˜¯å‰é¼»éŸ³ï¼Œå¼ å¤§å˜´å·´è¯» angï¼",
            "in-ing": "è®°ä½ï¼šin æ˜¯å‰é¼»éŸ³ï¼Œing æ˜¯åé¼»éŸ³ï¼Œing åé¢æœ‰ä¸ª gï¼",
            "default": "å“å‘€ï¼Œè®©å®ƒé€ƒèµ°äº†ï¼å†ä»”ç»†çœ‹çœ‹æ‹¼éŸ³ï¼Œå¤šè¯»å‡ éè¯•è¯•ï¼"
        };

        // åˆå§‹åŒ–
        function init() {
            renderPokedex();

            // åŠ è½½ä¿å­˜çš„æ¸¸æˆæ¨¡å¼
            if (gameMode === 'connect') {
                document.getElementById('modeConnectBtn').classList.add('active');
            } else {
                document.getElementById('modeSelectBtn').classList.add('active');
            }

            // åŠ è½½ä¿å­˜çš„è¯­é€Ÿè®¾ç½®
            const savedSpeed = localStorage.getItem('speechSpeed');
            if (savedSpeed) {
                speechSpeed = parseFloat(savedSpeed);
            }

            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('service-worker.js');
            }
        }

        // ç•Œé¢åˆ‡æ¢
        function showScreen(screenName) {
            document.querySelectorAll('.game-container, .pokedex-screen, .settings-screen').forEach(el => {
                el.classList.remove('active');
            });

            if (screenName === 'game') {
                document.getElementById('gameScreen').classList.add('active');
                resetGame();
            } else if (screenName === 'pokedex') {
                document.getElementById('pokedexScreen').classList.add('active');
                renderPokedex();
            } else if (screenName === 'settings') {
                document.getElementById('settingsScreen').classList.add('active');
            }
        }

        // é­é‡å®å¯æ¢¦
        function encounterPokemon() {
            // é‡ç½®é”™è¯¯è®¡æ•°
            errorCount = 0;

            // éšæœºé€‰æ‹©ä¸€åªå®å¯æ¢¦
            currentPokemon = pokemonDatabase[Math.floor(Math.random() * pokemonDatabase.length)];

            // éšæœºé€‰æ‹©ä¸€ä¸ªæŒ‘æˆ˜é¢˜ç›®
            currentChallenge = currentPokemon.challenges[Math.floor(Math.random() * currentPokemon.challenges.length)];

            // é¢„åŠ è½½å›¾ç‰‡ï¼Œç¡®ä¿ç­”å¯¹åèƒ½ç«‹å³æ˜¾ç¤º
            const img = new Image();
            img.src = currentPokemon.image;

            // éšè—è‰ä¸›ï¼Œæ˜¾ç¤ºé­é‡ç•Œé¢
            document.getElementById('grassPatch').style.display = 'none';
            document.querySelector('.hint-text').style.display = 'none';
            document.getElementById('encounterScreen').classList.add('active');

            // æ˜¾ç¤ºå®å¯æ¢¦ä¿¡æ¯ï¼ˆé«˜äº®å½“å‰è€ƒå¯Ÿçš„å­—ï¼‰
            const charIndex = currentChallenge.charIndex;
            const nameChars = currentPokemon.name.split('');
            const highlightedName = nameChars.map((char, index) => {
                if (index === charIndex) {
                    return `<span class="highlight">${char}</span>`;
                }
                return char;
            }).join('');
            document.getElementById('pokemonName').innerHTML = highlightedName;
            document.getElementById('pokemonImage').src = currentPokemon.image;

            // ç”Ÿæˆé¢˜ç›®
            generateQuestion();

            // æ’­æ”¾è¯­éŸ³æç¤º
            setTimeout(() => {
                if (gameMode === 'connect') {
                    speak(`è¯·è¿çº¿æ‹¼å‡º${currentPokemon.name}çš„æ‹¼éŸ³`);
                } else {
                    const targetChar = nameChars[charIndex];
                    speak(`${currentPokemon.name}çš„${targetChar}å­—æ€ä¹ˆæ‹¼ï¼Ÿ`);
                }
            }, 500);
        }

        // ç”Ÿæˆé¢˜ç›®
        function generateQuestion() {
            const charIndex = currentChallenge.charIndex;
            const pinyin = currentPokemon.pinyin[charIndex];
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';

            if (gameMode === 'select') {
                // ç‚¹å‡»é€‰æ‹©æ¨¡å¼ï¼šåŸæœ‰é€»è¾‘
                const target = currentChallenge.target;

                // ç”Ÿæˆå¡«ç©ºé¢˜
                let blankPinyin = pinyin.replace(new RegExp(target, 'i'), '_'.repeat(target.length));
                document.getElementById('pinyinBlank').textContent = blankPinyin;

                // æ‰“ä¹±é€‰é¡¹é¡ºåº
                const shuffledOptions = [...currentChallenge.options].sort(() => Math.random() - 0.5);

                shuffledOptions.forEach(option => {
                    const pokeball = document.createElement('div');
                    pokeball.className = 'pokeball-option';
                    pokeball.innerHTML = `<span>${option}</span>`;
                    pokeball.onclick = () => checkAnswer(option);
                    optionsContainer.appendChild(pokeball);
                });
            } else {
                // è¿çº¿æ‹¼éŸ³æ¨¡å¼ï¼šå·¦è¾¹3ä¸ªå£°æ¯ï¼Œå³è¾¹3ä¸ªéŸµæ¯
                document.getElementById('pinyinBlank').textContent = 'è¯·è¿çº¿æ‹¼å‡ºæ‹¼éŸ³';

                // æ‹†åˆ†å½“å‰å­—çš„æ‹¼éŸ³
                const { initial, final } = splitPinyin(pinyin);

                // ç”Ÿæˆå·¦è¾¹3ä¸ªå£°æ¯é€‰é¡¹ï¼ˆ1ä¸ªæ­£ç¡® + 2ä¸ªå¹²æ‰°ï¼‰
                const leftOptions = [];
                if (initial) {
                    leftOptions.push({ value: initial, type: 'initial' });
                    // ç”Ÿæˆ2ä¸ªå£°æ¯å¹²æ‰°é¡¹
                    const initialDistractors = generateDistractors(initial, final, 2, 0);
                    leftOptions.push(...initialDistractors);
                } else {
                    // å¦‚æœæ²¡æœ‰å£°æ¯ï¼Œç”Ÿæˆ3ä¸ªå£°æ¯å¹²æ‰°é¡¹
                    const initialDistractors = generateDistractors('', final, 3, 0);
                    leftOptions.push(...initialDistractors);
                }
                // æ‰“ä¹±å·¦è¾¹é€‰é¡¹
                leftOptions.sort(() => Math.random() - 0.5);

                // ç”Ÿæˆå³è¾¹3ä¸ªéŸµæ¯é€‰é¡¹ï¼ˆ1ä¸ªæ­£ç¡® + 2ä¸ªå¹²æ‰°ï¼‰
                const rightOptions = [];
                rightOptions.push({ value: final, type: 'final' });
                // ç”Ÿæˆ2ä¸ªéŸµæ¯å¹²æ‰°é¡¹
                const finalDistractors = generateDistractors(initial, final, 0, 2);
                rightOptions.push(...finalDistractors);
                // æ‰“ä¹±å³è¾¹é€‰é¡¹
                rightOptions.sort(() => Math.random() - 0.5);

                // åˆ›å»ºå·¦è¾¹çš„å£°æ¯ç»„
                const leftGroup = document.createElement('div');
                leftGroup.className = 'connect-group left-group';
                leftOptions.forEach((option, index) => {
                    const pokeball = document.createElement('div');
                    pokeball.className = 'pokeball-option connect-mode';
                    pokeball.setAttribute('data-value', option.value);
                    pokeball.setAttribute('data-type', option.type);
                    pokeball.setAttribute('data-index', 'left-' + index);
                    pokeball.innerHTML = `<span>${option.value}</span>`;
                    pokeball.onclick = () => handleConnectClick(pokeball);
                    leftGroup.appendChild(pokeball);
                });

                // åˆ›å»ºå³è¾¹çš„éŸµæ¯ç»„
                const rightGroup = document.createElement('div');
                rightGroup.className = 'connect-group right-group';
                rightOptions.forEach((option, index) => {
                    const pokeball = document.createElement('div');
                    pokeball.className = 'pokeball-option connect-mode';
                    pokeball.setAttribute('data-value', option.value);
                    pokeball.setAttribute('data-type', option.type);
                    pokeball.setAttribute('data-index', 'right-' + index);
                    pokeball.innerHTML = `<span>${option.value}</span>`;
                    pokeball.onclick = () => handleConnectClick(pokeball);
                    rightGroup.appendChild(pokeball);
                });

                optionsContainer.appendChild(leftGroup);
                optionsContainer.appendChild(rightGroup);
            }
        }

        // å¤„ç†ç­”å¯¹çš„æƒ…å†µ
        function handleCorrectAnswer() {
            // ç¦ç”¨æ‰€æœ‰æŒ‰é’®ï¼ˆç­”å¯¹äº†ï¼‰
            document.querySelectorAll('.pokeball-option').forEach(el => {
                el.style.pointerEvents = 'none';
            });

            // è·å–æ‹¼éŸ³å’Œå­—ä¿¡æ¯
            const charIndex = currentChallenge ? currentChallenge.charIndex : 0;
            const fullPinyin = currentPokemon.pinyin[charIndex];
            const targetChar = currentPokemon.name.split('')[charIndex];

            // ç«‹å³æ˜¾ç¤ºå®Œæ•´çš„æ­£ç¡®æ‹¼éŸ³
            document.getElementById('pinyinBlank').textContent = fullPinyin;

            // ä½¿ç”¨æ ‡å‡†æ‹¼éŸ³æ‹¼è¯»æ–¹å¼
            const pinyinText = fullPinyin;
            let speechText = `${targetChar}å­—ï¼Œ${pinyinText}`;
            speak(speechText);

            // æ­£ç¡®ç­”æ¡ˆ - å»¶è¿Ÿæ˜¾ç¤ºï¼Œç­‰è¯­éŸ³æ’­å®Œ
            setTimeout(() => {
                document.querySelector('.pokemon-display').classList.remove('shadow');

                // ä¿å­˜æ•è·è®°å½•
                const isNewCapture = !capturedPokemon.includes(currentPokemon.id);
                if (isNewCapture) {
                    capturedPokemon.push(currentPokemon.id);
                    saveProgress();
                }

                // è§¦å‘åº†ç¥ç‰¹æ•ˆ
                createCelebration();

                // æ˜¾ç¤ºæˆåŠŸåé¦ˆï¼ˆå¸¦å›¾é‰´ä¿¡æ¯ï¼‰
                setTimeout(() => {
                    // ä½¿ç”¨æ‹¼è¯»æ–¹å¼å¿µå®Œæ•´çš„å®å¯æ¢¦åç§°ï¼ˆå£°æ¯æ•™å­¦éŸ³+éŸµæ¯æ•™å­¦éŸ³+å­—ï¼‰
                    const nameChars = currentPokemon.name.split('');
                    let fullSpeech = '';

                    // ä¸ºæ¯ä¸ªå­—æ‹¼è¯»ï¼Œå¹¶åœ¨æ¯ä¸ªå­—ä¹‹é—´æ·»åŠ åœé¡¿
                    nameChars.forEach((char, idx) => {
                        const pinyin = currentPokemon.pinyin[idx];
                        fullSpeech += speakPinyinWithTeaching(pinyin, char);

                        // åœ¨æ¯ä¸ªå­—åé¢æ·»åŠ åœé¡¿æ ‡è®°ï¼ˆé™¤äº†æœ€åä¸€ä¸ªå­—ï¼‰
                        if (idx < nameChars.length - 1) {
                            fullSpeech += 'ï¼Œï¼Œ'; // åŒé€—å·å¢åŠ åœé¡¿æ—¶é—´
                        }
                    });

                    // æœ€åå†å¿µä¸€éå®Œæ•´åå­—
                    fullSpeech += 'ã€‚' + currentPokemon.name;

                    speak(fullSpeech);

                    // æ ¹æ®åå­—å­—æ•°åŠ¨æ€è°ƒæ•´å»¶è¿Ÿæ—¶é—´
                    const delayTime = 2000 + (nameChars.length * 800);
                    setTimeout(() => {
                        speak('æ•è·æˆåŠŸ');
                        showSuccessFeedback(isNewCapture);
                    }, delayTime);
                }, 1500);
            }, 1500);

            // é‡ç½®è¿çº¿é€‰æ‹©çŠ¶æ€
            connectSelection = { first: null, second: null };
        }

        // æ£€æŸ¥ç­”æ¡ˆ
        function checkAnswer(selectedOption) {
            // è¿çº¿æ¨¡å¼çš„ç‰¹æ®Šå¤„ç†
            if (selectedOption === 'correct-connection') {
                // è¿çº¿æ­£ç¡®ï¼Œç›´æ¥è¿›å…¥æˆåŠŸæµç¨‹
                handleCorrectAnswer();
                return;
            }

            const correctAnswer = currentChallenge.target;
            const isCorrect = selectedOption === correctAnswer;

            // è·å–æ‹¼éŸ³å’Œæ•™å­¦å£è¯€
            const charIndex = currentChallenge.charIndex;
            const fullPinyin = currentPokemon.pinyin[charIndex];
            const targetChar = currentPokemon.name.split('')[charIndex];

            if (isCorrect) {
                handleCorrectAnswer();
            } else {
                // é”™è¯¯ç­”æ¡ˆ - å¢åŠ é”™è¯¯è®¡æ•°
                errorCount++;

                // ä¸´æ—¶ç¦ç”¨æ‰€æœ‰æŒ‰é’®ï¼Œé¿å…è¿ç»­ç‚¹å‡»
                document.querySelectorAll('.pokeball-option').forEach(el => {
                    el.style.pointerEvents = 'none';
                });

                // æ‰¾åˆ°è¢«ç‚¹å‡»çš„ç²¾çµçƒå¹¶æ·»åŠ æŠ–åŠ¨æ•ˆæœ
                const clickedBall = event.target.closest('.pokeball-option');
                if (clickedBall) {
                    clickedBall.classList.add('shake-error');

                    // æ™ºèƒ½è¯»å‡ºé”™è¯¯é€‰é¡¹ï¼ˆç¡®ä¿æ˜¯æœ‰æ•ˆçš„æ‹¼éŸ³å‘éŸ³ï¼‰
                    let wrongSpeech = '';
                    const challengeType = currentChallenge.type;

                    if (challengeType === 'initial') {
                        // å£°æ¯é¢˜ç›®ï¼šä½¿ç”¨å£°æ¯æ•™å­¦å‘éŸ³
                        const teaching = pinyinTeaching[selectedOption] || pinyinTeaching[selectedOption.toUpperCase()];
                        if (teaching) {
                            wrongSpeech = `${teaching}ï¼Œ${selectedOption}ï¼Œä¸å¯¹`;
                        } else {
                            // å¯¹äºzhã€chã€shç­‰ç»„åˆå£°æ¯ï¼Œç›´æ¥è¯»
                            wrongSpeech = `${selectedOption}ï¼Œä¸å¯¹`;
                        }
                    } else if (challengeType === 'final') {
                        // éŸµæ¯é¢˜ç›®ï¼šæ„å»ºå®Œæ•´æ‹¼éŸ³å¹¶è¯»å‡º
                        // è·å–å£°æ¯éƒ¨åˆ†ï¼ˆæ­£ç¡®ç­”æ¡ˆå‰é¢çš„éƒ¨åˆ†ï¼‰
                        const initialPart = fullPinyin.slice(0, fullPinyin.indexOf(correctAnswer));

                        // æ£€æŸ¥æ˜¯å¦æ˜¯é›¶å£°æ¯ï¼ˆç›´æ¥æ˜¯éŸµæ¯ï¼‰
                        if (initialPart === '') {
                            // é›¶å£°æ¯ï¼Œç›´æ¥è¯»éŸµæ¯
                            wrongSpeech = `${selectedOption}ï¼Œä¸å¯¹`;
                        } else {
                            // æœ‰å£°æ¯ï¼Œæ£€æŸ¥ç»„åˆæ˜¯å¦æœ‰æ•ˆ
                            const baseInitial = initialPart.normalize('NFD').replace(/[\u0300-\u036f]/g, '').toLowerCase();
                            if (isValidPinyin(baseInitial, selectedOption)) {
                                // ç»„åˆæœ‰æ•ˆï¼Œè¯»å®Œæ•´æ‹¼éŸ³
                                const wrongPinyin = initialPart + selectedOption;
                                wrongSpeech = `${wrongPinyin}ï¼Œä¸å¯¹`;
                            } else {
                                // ç»„åˆæ— æ•ˆï¼Œåˆ†åˆ«è¯»å£°æ¯å’ŒéŸµæ¯
                                const initialTeaching = pinyinTeaching[baseInitial];
                                const finalTeaching = pinyinTeaching[selectedOption.normalize('NFD').replace(/[\u0300-\u036f]/g, '')];
                                if (initialTeaching && finalTeaching) {
                                    wrongSpeech = `${initialTeaching}${finalTeaching}ï¼Œä¸å¯¹`;
                                } else {
                                    wrongSpeech = `${baseInitial}${selectedOption}ï¼Œä¸å¯¹`;
                                }
                            }
                        }
                    } else {
                        // æ•´ä½“è®¤è¯»æˆ–å…¶ä»–ç±»å‹ï¼šç›´æ¥è¯»é€‰é¡¹
                        wrongSpeech = `${selectedOption}ï¼Œä¸å¯¹`;
                    }

                    speak(wrongSpeech);

                    // æ£€æŸ¥æ˜¯å¦å·²ç»é”™è¯¯2æ¬¡
                    if (errorCount >= 2) {
                        // å®å¯æ¢¦é€ƒè·‘
                        setTimeout(() => {
                            const correctPinyinFull = currentPokemon.pinyin[charIndex];
                            speak(`æ­£ç¡®ç­”æ¡ˆæ˜¯${correctPinyinFull}ï¼Œå®å¯æ¢¦é€ƒèµ°äº†`);

                            // å®å¯æ¢¦é€ƒè·‘åŠ¨ç”»
                            const pokemonDisplay = document.querySelector('.pokemon-display');
                            pokemonDisplay.style.animation = 'shake-error 0.5s ease-in-out';

                            // 2ç§’åè¿”å›è‰ä¸›
                            setTimeout(() => {
                                closeFeedback();
                            }, 2500);
                        }, 1200);
                    } else {
                        // è¿˜æœ‰æœºä¼šï¼Œç§»é™¤é”™è¯¯é€‰é¡¹ç»§ç»­æŒ‘æˆ˜
                        setTimeout(() => {
                            clickedBall.style.opacity = '0';
                            clickedBall.style.transform = 'scale(0)';

                            setTimeout(() => {
                                clickedBall.remove();

                                // é‡æ–°å¯ç”¨å‰©ä½™çš„æŒ‰é’®
                                document.querySelectorAll('.pokeball-option').forEach(el => {
                                    el.style.pointerEvents = 'auto';
                                });

                                // æ£€æŸ¥æ˜¯å¦è¿˜æœ‰é€‰é¡¹ï¼ˆç†è®ºä¸Šè‡³å°‘è¿˜æœ‰æ­£ç¡®ç­”æ¡ˆï¼‰
                                const remainingOptions = document.querySelectorAll('.pokeball-option');
                                if (remainingOptions.length === 1) {
                                    // åªå‰©æœ€åä¸€ä¸ªé€‰é¡¹äº†ï¼Œç»™ä¸ªæç¤º
                                    setTimeout(() => {
                                        speak('è¯•è¯•è¿™ä¸ª');
                                    }, 500);
                                }
                            }, 300);
                        }, 1200);
                    }
                }
            }
        }

        // è·å–æ•™å­¦æç¤º
        function getTeachingTip(correct, wrong) {
            // b/d æ˜“æ··æ·†
            if ((correct === 'b' && wrong === 'd') || (correct === 'd' && wrong === 'b')) {
                return teachingTips["b-d"];
            }
            // p/q æ˜“æ··æ·†
            if ((correct === 'p' && wrong === 'q') || (correct === 'q' && wrong === 'p')) {
                return teachingTips["p-q"];
            }
            // å‰åé¼»éŸ³
            if (correct.includes('ang') && wrong.includes('eng')) {
                return teachingTips["ang-eng"];
            }
            if (correct.includes('in') && !correct.includes('ing') && wrong.includes('ing')) {
                return teachingTips["in-ing"];
            }

            return teachingTips["default"];
        }

        // åˆ›å»ºåº†ç¥ç‰¹æ•ˆ
        function createCelebration() {
            const celebration = document.createElement('div');
            celebration.className = 'celebration';
            document.body.appendChild(celebration);

            // åˆ›å»ºå½©çº¸
            const colors = ['#FFE66D', '#FF6B6B', '#4ECDC4', '#95E1D3', '#F38181'];
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 0.5 + 's';
                    confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    celebration.appendChild(confetti);
                }, i * 30);
            }

            // åˆ›å»ºé—ªå…‰æ•ˆæœ
            const display = document.querySelector('.pokemon-display');
            const rect = display.getBoundingClientRect();
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const sparkle = document.createElement('div');
                    sparkle.className = 'sparkle';
                    sparkle.style.left = (rect.left + Math.random() * rect.width) + 'px';
                    sparkle.style.top = (rect.top + Math.random() * rect.height) + 'px';
                    document.body.appendChild(sparkle);

                    setTimeout(() => sparkle.remove(), 1000);
                }, i * 50);
            }

            // 3ç§’åæ¸…é™¤åº†ç¥æ•ˆæœ
            setTimeout(() => celebration.remove(), 3000);
        }

        // æ˜¾ç¤ºæˆåŠŸåé¦ˆï¼ˆç®€åŒ–ç‰ˆï¼šåªæ˜¾ç¤ºå›¾ç‰‡å’Œç»§ç»­æŒ‰é’®ï¼‰
        function showSuccessFeedback(isNewCapture) {
            const modal = document.getElementById('feedbackModal');
            const content = document.getElementById('feedbackContent');

            content.className = 'feedback-content success';

            // ç®€åŒ–ç‰ˆï¼šåªæ˜¾ç¤ºå¤§å›¾å’Œç»§ç»­æŒ‰é’®ï¼ˆé¢„åŠ è½½å›¾ç‰‡ï¼‰
            const infoCard = `
                <div style="text-align: center;">
                    <img src="${currentPokemon.image}" alt="${currentPokemon.name}"
                         style="width: 350px; height: 350px; object-fit: contain; margin: 20px auto;">
                </div>
                <button onclick="closeFeedback()" style="font-size: 36px; padding: 25px 60px; margin-top: 30px;">ç»§ç»­å†’é™©</button>
            `;

            content.innerHTML = infoCard;
            modal.classList.add('active');
        }

        // æ˜¾ç¤ºåé¦ˆ
        function showFeedback(isSuccess, title, message, autoClose = false) {
            const modal = document.getElementById('feedbackModal');
            const content = document.getElementById('feedbackContent');
            const titleEl = document.getElementById('feedbackTitle');
            const messageEl = document.getElementById('feedbackMessage');

            content.className = 'feedback-content ' + (isSuccess ? 'success' : 'error');

            // é”™è¯¯æ—¶æ·»åŠ æŠ–åŠ¨æ•ˆæœ
            if (!isSuccess) {
                content.classList.add('shake-error');
                setTimeout(() => content.classList.remove('shake-error'), 500);
            }

            titleEl.textContent = title;
            messageEl.innerHTML = message;
            modal.classList.add('active');

            // å¦‚æœæ˜¯è‡ªåŠ¨å…³é—­æ¨¡å¼ï¼Œéšè—æŒ‰é’®æˆ–æ˜¾ç¤ºå€’è®¡æ—¶
            const button = content.querySelector('button');
            if (button && autoClose) {
                button.textContent = 'æ­£åœ¨è¿”å›è‰ä¸›...';
                button.disabled = true;
                button.style.opacity = '0.6';
            }
        }

        // å…³é—­åé¦ˆ
        function closeFeedback() {
            document.getElementById('feedbackModal').classList.remove('active');
            resetGame();
        }

        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            document.getElementById('grassPatch').style.display = 'block';
            document.querySelector('.hint-text').style.display = 'block';
            document.getElementById('encounterScreen').classList.remove('active');
            document.querySelector('.pokemon-display').classList.add('shadow');

            // é‡æ–°å¯ç”¨æŒ‰é’®
            document.querySelectorAll('.pokeball-option').forEach(el => {
                el.style.pointerEvents = 'auto';
            });
        }

        // è®¾ç½®å›¾é‰´ç­›é€‰æ¨¡å¼
        function setPokedexFilter(mode) {
            pokedexFilter = mode;

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // é‡æ–°æ¸²æŸ“å›¾é‰´
            renderPokedex();
        }

        // æ¸²æŸ“å›¾é‰´
        function renderPokedex() {
            const container = document.getElementById('pokedexScreen');
            const grid = document.getElementById('pokedexGrid');
            grid.innerHTML = '';

            // ç§»é™¤æ—§çš„ç»Ÿè®¡ä¿¡æ¯ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
            const oldStats = container.querySelector('.pokedex-stats');
            if (oldStats) {
                oldStats.remove();
            }

            // æ ¹æ®ç­›é€‰æ¨¡å¼è¿‡æ»¤å®å¯æ¢¦
            let displayPokemon = pokemonDatabase;
            if (pokedexFilter === 'captured') {
                displayPokemon = pokemonDatabase.filter(p => capturedPokemon.includes(p.id));
            }

            // æ·»åŠ å›¾é‰´ç»Ÿè®¡ä¿¡æ¯
            const statsDiv = document.createElement('div');
            statsDiv.className = 'pokedex-stats';
            statsDiv.style.cssText = 'text-align: center; color: white; font-size: 36px; font-weight: bold; margin: 25px auto; padding: 30px; background: rgba(255,255,255,0.2); border-radius: 25px; max-width: 700px;';

            const statsText = pokedexFilter === 'captured'
                ? `âœ… å·²æ•è·ï¼š${capturedPokemon.length} åª`
                : `ğŸ“Š æ•è·è¿›åº¦ï¼š${capturedPokemon.length} / ${pokemonDatabase.length}`;

            const encouragement = capturedPokemon.length === 0 ? 'å¼€å§‹ä½ çš„å†’é™©å§ï¼' :
                                  capturedPokemon.length === pokemonDatabase.length ? 'ğŸ‰ æ­å–œï¼å·²æ•è·å…¨éƒ¨å®å¯æ¢¦ï¼' :
                                  'ç»§ç»­åŠ æ²¹ï¼';

            statsDiv.innerHTML = `
                ${statsText}
                <br>
                <small style="font-size: 28px; font-weight: normal;">
                    ${encouragement}
                </small>
            `;
            container.insertBefore(statsDiv, container.querySelector('.pokedex-filter').nextSibling);

            // å¦‚æœæ˜¯"å·²æ•è·"æ¨¡å¼ä¸”æ²¡æœ‰æ•è·ä»»ä½•å®å¯æ¢¦ï¼Œæ˜¾ç¤ºæç¤º
            if (pokedexFilter === 'captured' && displayPokemon.length === 0) {
                const emptyDiv = document.createElement('div');
                emptyDiv.style.cssText = 'text-align: center; color: white; font-size: 32px; padding: 80px 20px; margin: 0 auto;';
                emptyDiv.innerHTML = `
                    <div style="font-size: 120px; margin-bottom: 30px;">ğŸ®</div>
                    <div style="font-weight: bold; margin-bottom: 20px; font-size: 38px;">è¿˜æ²¡æœ‰æ•è·å®å¯æ¢¦</div>
                    <div style="font-size: 28px; opacity: 0.9;">å¿«å»è‰ä¸›é‡Œå¯»æ‰¾å§ï¼</div>
                `;
                grid.appendChild(emptyDiv);
                return;
            }

            // æ¸²æŸ“å®å¯æ¢¦å¡ç‰‡ï¼ˆä½¿ç”¨æ‡’åŠ è½½ä¼˜åŒ–ï¼‰
            displayPokemon.forEach(pokemon => {
                const isCaptured = capturedPokemon.includes(pokemon.id);
                const card = document.createElement('div');
                card.className = 'pokedex-card' + (isCaptured ? '' : ' locked');

                if (isCaptured) {
                    // å·²æ•æ‰ï¼šæ˜¾ç¤ºå®Œæ•´ä¿¡æ¯ï¼ˆä½¿ç”¨æ‡’åŠ è½½ï¼‰
                    card.innerHTML = `
                        <button class="pokedex-sound-btn" onclick="speakPokemonName(${pokemon.id})">ğŸ”Š</button>
                        <img src="${pokemon.image}" loading="lazy" alt="${pokemon.name}">
                        <div class="pokemon-info">
                            <strong>${pokemon.name}</strong>
                            <br>
                            <small style="color: #666;">#${String(pokemon.id).padStart(3, '0')}</small>
                            <br>
                            <small style="color: #FF6B6B; font-weight: bold;">${pokemon.pinyin.join(' ')}</small>
                        </div>
                    `;
                } else {
                    // æœªæ•æ‰ï¼šæ˜¾ç¤ºé—®å·ï¼ˆä½¿ç”¨æ‡’åŠ è½½ï¼‰
                    card.innerHTML = `
                        <img src="${pokemon.image}" loading="lazy" alt="æœªçŸ¥å®å¯æ¢¦">
                        <div class="pokemon-info">
                            <strong>???</strong>
                            <br>
                            <small style="color: #999;">æœªæ•æ‰</small>
                        </div>
                    `;
                }

                grid.appendChild(card);
            });
        }

        // ä¿å­˜è¿›åº¦
        function saveProgress() {
            localStorage.setItem('pokemonPinyinProgress', JSON.stringify(capturedPokemon));
        }

        // åŠ è½½è¿›åº¦
        function loadProgress() {
            const saved = localStorage.getItem('pokemonPinyinProgress');
            return saved ? JSON.parse(saved) : [];
        }

        // æ¸…é™¤æ•°æ®
        function clearData() {
            if (confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰è¿›åº¦å—ï¼Ÿè¿™å°†åˆ é™¤æ‰€æœ‰å·²æ•æ‰çš„å®å¯æ¢¦ï¼')) {
                localStorage.removeItem('pokemonPinyinProgress');
                capturedPokemon = [];
                alert('è¿›åº¦å·²æ¸…é™¤ï¼');
                showScreen('game');
            }
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.onload = init;
    </script>
</body>
</html>
